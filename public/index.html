<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Rai API</title>
    <link rel="icon" href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAADw8PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABERAREQEREAEREBERAREQAREQEREBERABERAREQEREAAAAAAAAAAAAAAAAAABERAAAAAAAAEREAAAAAAAAREQAAAAAAABERAAAAAAAAAAAAAAABERAAAAAAAAEREAAAAAAAAREQAAAAAAABERAAAAAAAAAAAAAAD//wAAhCEAAIQhAACEIQAAhCEAAP//AAD/4QAA/+EAAP/hAAD/4QAA//8AAPw/AAD8PwAA/D8AAPw/AAD//wAA" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/darkly/bootstrap.min.css">
    <style type="text/css">
        ul {
            margin-left: -20px;
        }
        #link ul {
            list-style-type: none;
        }
        #link li {
            margin-left: -20px;
        }
        #link a {
            width: 70%;
        }
        #qualita .text-warning {
            margin-left: -20px;
        }
        li > a {
            margin-top: 10px;
        }
        a > img {
            position: absolute;
            top: 0;
            right: 0;
            border: 0;
        }

    </style>
</head>
<body>

<div class="container-fluid">
    <div id="loadingModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Loading data</h4>
                </div>
                <div class="modal-body">
                    <div class="progress">
                        <div class="progress-bar progress-bar-striped active" role="progressbar" style="width: 100%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-2">
            <h2>Data</h2>
            <div class="input-group date col-md-12 col-xs-6" id="datepicker">
                <input type="text" class="form-control"/>
                <span class="input-group-addon">
                    <span class="glyphicon glyphicon-calendar"></span>
                </span>
            </div>
            <h2>Canali</h2>
            <ul id="canali"></ul>
        </div>
        <div class="col-md-5"><h2>Programmi</h2><ul id="programmi"></ul></div>
        <div class="col-md-2"><h2>Qualit&agrave;</h2><ul id="qualita"></ul></div>
        <div id="link" class="col-md-3"><h2>Azioni</h2>
            <ul>
                <li id="video">
                    <a class="btn btn-success" target="_blank">
                        <span class="glyphicon glyphicon-play" aria-hidden="true"></span> Vedi
                    </a>
                </li>
                <li id="file">
                    <a class="btn btn-success" target="_blank">
                        <span class="glyphicon glyphicon-save" aria-hidden="true"></span> Salva su Computer
                    </a>
                </li>
                <li id="dropbox">
                    <a class="btn btn-success" target="_blank">
                        <i class="fa fa-dropbox" aria-hidden="true"></i> Salva su Dropbox
                    </a>
                </li>
                <li id="copy">
                    <a class="btn btn-success" target="_blank">
                        <i class="fa fa-copy" aria-hidden="true"></i> Copia URL
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <a href="https://github.com/maxcanna/raiapi" title="Fork me on GitHub">
        <img alt="Fork me on GitHub" src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png">
    </a>
</div>

<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.5/moment-timezone-with-data-2010-2020.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/locale/it.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/js/bootstrap-datetimepicker.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js"></script>
<script src="//www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="YOUR-APP-KEY"></script>
<script src="models.js"></script>
<script src="collections.js"></script>
<script src="views.js"></script>

<script type="text/template" id="template-item">
    <li>
        <a id="item-link" href="#" data-id="<%= model.id %>"><%= model.get('name') %></a>
        <% if(!model.has('canale')){ %>
            <a href="/canali/<%= model.id %>/rss.xml" target="_blank"><i class="fa fa-rss-square" aria-hidden="true"></i></a>
        <% } %>
    </li>
</script>
<script type="text/template" id="template-na">
    <li style="list-style-type: none"><div class="text-warning" role="alert">Programma non disponibile</div></li>
</script>

<script>
    $(function () {
        var canaliView = new CanaliView();
        var datepicker = $('#datepicker');
        var yesterday = moment().tz('Europe/Rome').subtract(1, 'd').startOf('day');
        var aweekago = moment().tz('Europe/Rome').subtract(1, 'w').startOf('day');;

        $('#loadingModal').modal({backdrop: 'static'});
        datepicker.datetimepicker({
                    locale: 'it',
                    format: 'L',
                    maxDate: yesterday,
                    minDate: aweekago,
                    defaultDate: yesterday,
                    focusOnShow: false,
                    widgetPositioning: {
                        horizontal: 'left',
                        vertical: 'auto',
                    },
                })
                .on('dp.change', function (e) {
                    canaliView.setOptions({data: e.date.toDate()});
                })
                .datetimepicker('date', yesterday);

        canaliView.setOptions({data: yesterday.toDate()});
    });
</script>

</body>
</html>