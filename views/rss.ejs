<%
var now = new Date();
var yesterday = new Date();
yesterday.setDate(now.getDate()-1);
var dateTag = `${yesterday.getFullYear()} ${('0'+(yesterday.getMonth()+1)).slice(-2)} ${('0'+(yesterday.getDate())).slice(-2)}`;
var nameTag = 'WEBRip.AAC.x264.mp4';
%><rss version="2.0" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Rai API - <%- canale %></title>
        <description>Rai API RSS feed for <%- canale %></description>
        <generator>raiapi.js</generator>
        <link>https://<%- hostname %></link>
        <language>it-IT</language>
        <lastBuildDate><%- now.toGMTString(); %></lastBuildDate>
        <copyright>(c) <%- now.getFullYear() %> <%- hostname %></copyright>
        <atom:link href="https://<%- hostname+url %>" rel="self" type="application/rss+xml" />
        <% programmi.forEach(programma => { %><item>
            <%
                var date = programma.name.toUpperCase().match(/S\d+E\d+/g) ? '' : dateTag;
            %>
            <title><![CDATA[<%- `${programma.name} ${date}` %>]]></title>
            <description>
                <![CDATA[<%- `${programma.name}.${date}.${nameTag}`.replace(/( - | )/g, '.').replace(/\.+/g, '.') %>]]>
            </description>
            <link><%- programma.url %></link>
            <guid><%- programma.url %></guid>
            <enclosure url="<%- programma.url %>" type="video/mp4" length="1024" />
            <pubDate><%- now.toGMTString(); %></pubDate>
        </item>
        <% }); %>
    </channel>
</rss>
